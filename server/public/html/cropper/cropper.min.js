/*!
 * Cropper v0.5.0
 * https://github.com/fengyuanchen/cropperjs
 *
 * Copyright (c) 2015 Fengyuan Chen
 * Released under the MIT license
 *
 * Date: 2015-12-05T09:05:03.769Z
 */
!function(t,i){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?i(t,!0):function(t){if(!t.document)throw new Error("Cropper requires a window with a document");return i(t)}:i(t)}("undefined"!=typeof window?window:this,function(t,i){"use strict";function e(t){return _t.call(t).slice(8,-1).toLowerCase()}function a(t){return"string"==typeof t}function s(t){return"number"==typeof t&&!isNaN(t)}function n(t){return"undefined"==typeof t}function o(t){return"object"==typeof t&&null!==t}function h(t){var i,e;if(!o(t))return!1;try{return i=t.constructor,e=i.prototype,i&&e&&jt.call(e,"isPrototypeOf")}catch(a){return!1}}function r(t){return"function"===e(t)}function c(t){return Array.isArray?Array.isArray(t):"array"===e(t)}function l(t,i){var e=[];return s(i)&&e.push(i),e.slice.apply(t,e)}function p(t,i){var e=-1;return u(i,function(i,a){return i===t?(e=a,!1):void 0}),e}function d(t){return a(t)||(t=String(t)),t=t.trim?t.trim():t.replace(ft,"$1")}function u(t,i){var e,a;if(t&&r(i))if(c(t)||s(t.length))for(a=0,e=t.length;e>a&&i.call(t,t[a],a,t)!==!1;a++);else if(o(t))for(a in t)if(jt.call(t,a)&&i.call(t,t[a],a,t)===!1)break;return t}function g(t){var i=l(arguments);return i.length>1&&i.shift(),u(i,function(i){u(i,function(i,e){t[e]=i})}),t}function f(t,i){var e=l(arguments,2);return function(){return t.apply(i,e.concat(l(arguments)))}}function m(t){return d(t).split(gt)}function v(t,i){return t.className.indexOf(i)>-1}function w(t,i){var e;return s(t.length)?u(t,function(t){w(t,i)}):(e=m(t.className),u(m(i),function(t){p(t,e)<0&&e.push(t)}),void(t.className=e.join(" ")))}function x(t,i){var e;return s(t.length)?u(t,function(t){x(t,i)}):(e=m(t.className),u(m(i),function(t,i){(i=p(t,e))>-1&&e.splice(i,1)}),void(t.className=e.join(" ")))}function b(t,i,e){return e?w(t,i):x(t,i)}function D(t,i){return o(t[i])?t[i]:t.dataset?t.dataset[i]:t.getAttribute("data-"+i)}function C(t,i,e){o(e)&&n(t[i])?t[i]=e:t.dataset?t.dataset[i]=e:t.setAttribute("data-"+i,e)}function B(t,i){o(t[i])?delete t[i]:t.dataset?delete t.dataset[i]:t.removeAttribute("data-"+i)}function y(t,i,e){var a;if(r(e))return a=d(i).split(gt),a.length>1?u(a,function(i){y(t,i,e)}):void(t.addEventListener?t.addEventListener(i,e,!1):t.attachEvent&&t.attachEvent("on"+i,e))}function L(t,i,e){var a;if(r(e))return a=d(i).split(gt),a.length>1?u(a,function(i){L(t,i,e)}):void(t.removeEventListener?t.removeEventListener(i,e,!1):t.detachEvent&&t.detachEvent("on"+i,e))}function T(t){t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}function k(i){var e,a=i||t.event;return a.target||(a.target=a.srcElement||j),s(a.pageX)||(e=j.documentElement,a.pageX=a.clientX+(t.scrollX||e&&e.scrollLeft||0)-(e&&e.clientLeft||0),a.pageY=a.clientY+(t.scrollY||e&&e.scrollTop||0)-(e&&e.clientTop||0)),a}function M(i){var e=j.documentElement,a=i.getBoundingClientRect();return{left:a.left+(t.scrollX||e&&e.scrollLeft||0)-(e&&e.clientLeft||0),top:a.top+(t.scrollY||e&&e.scrollTop||0)-(e&&e.clientTop||0)}}function X(t,i){return t.querySelector(i)}function W(t,i){return t.querySelectorAll(i)}function Y(t,i){t.parentNode.insertBefore(i,t)}function H(t,i){t.appendChild(i)}function E(t){t.parentNode.removeChild(t)}function R(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function z(t){var i=t.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return i&&(i[1]!==q.protocol||i[2]!==q.hostname||i[3]!==q.port)}function O(t){var i="timestamp="+(new Date).getTime();return t+(-1===t.indexOf("?")?"?":"&")+i}function U(t,i){var e;return t.naturalWidth?i(t.naturalWidth,t.naturalHeight):(e=j.createElement("img"),e.onload=function(){i(this.width,this.height)},void(e.src=t.src))}function I(t){var i=[],e=t.rotate,a=t.scaleX,n=t.scaleY;return s(e)&&i.push("rotate("+e+"deg)"),s(a)&&s(n)&&i.push("scale("+a+","+n+")"),i.length?i.join(" "):"none"}function A(t,i){var e,a,s=zt(t.degree)%180,n=(s>90?180-s:s)*Math.PI/180,o=Ot(n),h=Ut(n),r=t.width,c=t.height,l=t.aspectRatio;return i?(e=r/(h+o/l),a=e/l):(e=r*h+c*o,a=r*o+c*h),{width:e,height:a}}function N(t,i){var e,a,n,o=j.createElement("canvas"),h=o.getContext("2d"),r=0,c=0,l=i.naturalWidth,p=i.naturalHeight,d=i.rotate,u=i.scaleX,g=i.scaleY,f=s(u)&&s(g)&&(1!==u||1!==g),m=s(d)&&0!==d,v=m||f,w=l,x=p;return f&&(e=l/2,a=p/2),m&&(n=A({width:l,height:p,degree:d}),w=n.width,x=n.height,e=n.width/2,a=n.height/2),o.width=w,o.height=x,v&&(r=-l/2,c=-p/2,h.save(),h.translate(e,a)),m&&h.rotate(d*Math.PI/180),f&&h.scale(u,g),h.drawImage(t,Nt(r),Nt(c),Nt(l),Nt(p)),v&&h.restore(),o}function S(t,i,e){var a,s="";for(a=i,e+=i;e>a;a++)s+=qt(t.getUint8(a));return s}function P(t){var i,e,a,s,n,o,h,r,c,l,p=new Z(t),d=p.byteLength;if(255===p.getUint8(0)&&216===p.getUint8(1))for(c=2;d>c;){if(255===p.getUint8(c)&&225===p.getUint8(c+1)){h=c;break}c++}if(h&&(e=h+4,a=h+10,"Exif"===S(p,e,4)&&(o=p.getUint16(a),n=18761===o,(n||19789===o)&&42===p.getUint16(a+2,n)&&(s=p.getUint32(a+4,n),s>=8&&(r=a+s)))),r)for(d=p.getUint16(r,n),l=0;d>l;l++)if(c=r+12*l+2,274===p.getUint16(c,n)){c+=8,i=p.getUint16(c,n),p.setUint16(c,1,n);break}return i}function _(t,i){this.element=t,this.options=g({},_.DEFAULTS,h(i)&&i),this.isLoaded=!1,this.isBuilt=!1,this.isCompleted=!1,this.isRotated=!1,this.isCropped=!1,this.isDisabled=!1,this.isReplaced=!1,this.isLimited=!1,this.isImg=!1,this.originalUrl="",this.canvasData=null,this.cropBoxData=null,this.previews=null,this.init()}var j=t.document,q=t.location,F=t.ArrayBuffer,V=t.Uint8Array,Z=t.DataView,$=t.btoa,K="cropper",G="cropper-modal",J="cropper-hide",Q="cropper-hidden",tt="cropper-invisible",it="cropper-move",et="cropper-crop",at="cropper-disabled",st="cropper-bg",nt="mousedown touchstart pointerdown MSPointerDown",ot="mousemove touchmove pointermove MSPointerMove",ht="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",rt="wheel mousewheel DOMMouseScroll",ct="dblclick",lt="resize",pt="error",dt="load",ut=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,gt=/\s+/,ft=/^\s+(.*)\s+^/,mt="preview",vt="action",wt="e",xt="w",bt="s",Dt="n",Ct="se",Bt="sw",yt="ne",Lt="nw",Tt="all",kt="crop",Mt="move",Xt="zoom",Wt="none",Yt=!!j.createElement("canvas").getContext,Ht=Number,Et=Math.min,Rt=Math.max,zt=Math.abs,Ot=Math.sin,Ut=Math.cos,It=Math.sqrt,At=Math.round,Nt=Math.floor,St={version:"0.5.0"},Pt={},_t=Pt.toString,jt=Pt.hasOwnProperty,qt=String.fromCharCode;g(St,{init:function(){var t,i=this.element,e=i.tagName.toLowerCase();if(!D(i,K)){if(C(i,K,this),"img"===e){if(this.isImg=!0,this.originalUrl=t=i.getAttribute("src"),!t)return;t=i.src}else"canvas"===e&&Yt&&(t=i.toDataURL());this.load(t)}},load:function(t){var i,e;if(t){if(this.url=t,this.imageData={},!this.options.checkOrientation||!F)return this.clone();i=f(this.read,this),e=new XMLHttpRequest,e.onload=function(){i(this.response)},e.open("get",t),e.responseType="arraybuffer",e.send()}},read:function(t){var i,e,a,s=this.options,n=P(t),o={},h="";if(n)switch(u(new V(t),function(t){h+=qt(t)}),this.url="data:image/jpeg;base64,"+$(h),n){case 2:e=-1;break;case 3:i=-180;break;case 4:a=-1;break;case 5:i=90,a=-1;break;case 6:i=90;break;case 7:i=90,e=-1;break;case 8:i=-90}s.rotatable&&(o.rotate=i),s.scalable&&(o.scaleX=e,o.scaleY=a),this.imageData=o,this.clone()},clone:function(){var t,i,e,a,s,n=this.options,o=this.element,h=this.url;r(n.build)&&n.build.call(o)===!1||(n.checkCrossOrigin&&z(h)&&(t=o.crossOrigin,t||(t="anonymous",i=O(h))),this.crossOrigin=t,this.crossOriginUrl=i,e=j.createElement("img"),t&&(e.crossOrigin=t),e.src=i||h,this.image=e,this._start=a=f(this.start,this),this._stop=s=f(this.stop,this),this.isImg?o.complete?this.start():y(o,dt,a):(y(e,dt,a),y(e,pt,s),w(e,J),Y(o,e)))},start:function(t){var i=this.isImg?this.element:this.image;t&&(L(i,dt,this._start),L(i,pt,this._stop)),U(i,f(function(t,i){g(this.imageData,{naturalWidth:t,naturalHeight:i,aspectRatio:t/i}),this.isLoaded=!0,this.build()},this))},stop:function(){var t=this.image;L(t,dt,this._start),L(t,pt,this._stop),E(t),this.image=null}}),g(St,{build:function(){var t,i,e,a,s,n,o=this.options,h=this.element,c=this.image;this.isLoaded&&(this.isBuilt&&this.unbuild(),t=j.createElement("div"),t.innerHTML=_.TEMPLATE,this.container=h.parentNode,this.cropper=i=X(t,".cropper-container"),this.canvas=e=X(i,".cropper-canvas"),this.dragBox=a=X(i,".cropper-drag-box"),this.cropBox=s=X(i,".cropper-crop-box"),this.viewBox=X(i,".cropper-view-box"),this.face=n=X(s,".cropper-face"),H(e,c),w(h,Q),Y(h,i),this.isImg||x(c,J),this.initPreview(),this.bind(),o.aspectRatio=Rt(0,o.aspectRatio)||NaN,o.viewMode=Rt(0,Et(3,At(o.viewMode)))||0,o.autoCrop?(this.isCropped=!0,o.modal&&w(a,G)):w(s,Q),o.guides||w(W(s,".cropper-dashed"),Q),o.center||w(X(s,".cropper-center"),Q),o.background&&w(i,st),o.highlight||w(n,tt),o.cropBoxMovable&&(w(n,it),C(n,vt,Tt)),o.cropBoxResizable||(w(W(s,".cropper-line"),Q),w(W(s,".cropper-point"),Q)),this.setDragMode(o.dragMode),this.render(),this.isBuilt=!0,this.setData(o.data),setTimeout(f(function(){r(o.built)&&o.built.call(h),r(o.crop)&&o.crop.call(h,this.getData()),this.isCompleted=!0},this),0))},unbuild:function(){this.isBuilt&&(this.isBuilt=!1,this.initialImageData=null,this.initialCanvasData=null,this.initialCropBoxData=null,this.containerData=null,this.canvasData=null,this.cropBoxData=null,this.unbind(),this.resetPreview(),this.previews=null,this.viewBox=null,this.cropBox=null,this.dragBox=null,this.canvas=null,this.container=null,E(this.cropper),this.cropper=null)}}),g(St,{render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.isCropped&&this.renderCropBox()},initContainer:function(){var t,i=this.options,e=this.element,a=this.container,s=this.cropper;w(s,Q),x(e,Q),this.containerData=t={width:Rt(a.offsetWidth,Ht(i.minContainerWidth)||200),height:Rt(a.offsetHeight,Ht(i.minContainerHeight)||100)},s.style.cssText="width:"+t.width+"px;height:"+t.height+"px;",w(e,Q),x(s,Q)},initCanvas:function(){var t,i,e=this.options.viewMode,a=this.containerData,s=a.width,n=a.height,o=this.imageData,h=o.naturalWidth,r=o.naturalHeight,c=o.aspectRatio,l=s,p=n;o.rotate&&(i=A({width:h,height:r,degree:o.rotate}),h=i.width,r=i.height,c=i.width/i.height),n*c>s?3===e?l=n*c:p=s/c:3===e?p=s/c:l=n*c,t={naturalWidth:h,naturalHeight:r,aspectRatio:c,width:l,height:p},t.oldLeft=t.left=(s-l)/2,t.oldTop=t.top=(n-p)/2,this.canvasData=t,this.isLimited=1===e||2===e,this.limitCanvas(!0,!0),this.initialImageData=g({},o),this.initialCanvasData=g({},t)},limitCanvas:function(t,i){var e,a,s,n,o=this.options,h=o.viewMode,r=this.containerData,c=r.width,l=r.height,p=this.canvasData,d=p.aspectRatio,u=this.cropBoxData,g=this.isCropped&&u;t&&(e=Ht(o.minCanvasWidth)||0,a=Ht(o.minCanvasHeight)||0,h&&(h>1?(e=Rt(e,c),a=Rt(a,l),3===h&&(a*d>e?e=a*d:a=e/d)):e?e=Rt(e,g?u.width:0):a?a=Rt(a,g?u.height:0):g&&(e=u.width,a=u.height,a*d>e?e=a*d:a=e/d)),e&&a?a*d>e?a=e/d:e=a*d:e?a=e/d:a&&(e=a*d),p.minWidth=e,p.minHeight=a,p.maxWidth=1/0,p.maxHeight=1/0),i&&(h?(s=c-p.width,n=l-p.height,p.minLeft=Et(0,s),p.minTop=Et(0,n),p.maxLeft=Rt(0,s),p.maxTop=Rt(0,n),g&&this.isLimited&&(p.minLeft=Et(u.left,u.left+u.width-p.width),p.minTop=Et(u.top,u.top+u.height-p.height),p.maxLeft=u.left,p.maxTop=u.top,2===h&&(p.width>=c&&(p.minLeft=Et(0,s),p.maxLeft=Rt(0,s)),p.height>=l&&(p.minTop=Et(0,n),p.maxTop=Rt(0,n))))):(p.minLeft=-p.width,p.minTop=-p.height,p.maxLeft=c,p.maxTop=l))},renderCanvas:function(t){var i,e,a=this.canvasData,s=this.imageData,n=s.rotate,o=s.naturalWidth,h=s.naturalHeight;this.isRotated&&(this.isRotated=!1,e=A({width:s.width,height:s.height,degree:n}),i=e.width/e.height,i!==a.aspectRatio&&(a.left-=(e.width-a.width)/2,a.top-=(e.height-a.height)/2,a.width=e.width,a.height=e.height,a.aspectRatio=i,a.naturalWidth=o,a.naturalHeight=h,n%180&&(e=A({width:o,height:h,degree:n}),a.naturalWidth=e.width,a.naturalHeight=e.height),this.limitCanvas(!0,!1))),(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Et(Rt(a.width,a.minWidth),a.maxWidth),a.height=Et(Rt(a.height,a.minHeight),a.maxHeight),this.limitCanvas(!1,!0),a.oldLeft=a.left=Et(Rt(a.left,a.minLeft),a.maxLeft),a.oldTop=a.top=Et(Rt(a.top,a.minTop),a.maxTop),this.canvas.style.cssText="width:"+a.width+"px;height:"+a.height+"px;left:"+a.left+"px;top:"+a.top+"px;",this.renderImage(),this.isCropped&&this.isLimited&&this.limitCropBox(!0,!0),t&&this.output()},renderImage:function(t){var i,e,a=this.canvasData,s=this.imageData;s.rotate&&(i=A({width:a.width,height:a.height,degree:s.rotate,aspectRatio:s.aspectRatio},!0)),g(s,i?{width:i.width,height:i.height,left:(a.width-i.width)/2,top:(a.height-i.height)/2}:{width:a.width,height:a.height,left:0,top:0}),e=I(s),this.image.style.cssText="width:"+s.width+"px;height:"+s.height+"px;margin-left:"+s.left+"px;margin-top:"+s.top+"px;-webkit-transform:"+e+";-ms-transform:"+e+";transform:"+e+";",t&&this.output()},initCropBox:function(){var t=this.options,i=t.aspectRatio,e=Ht(t.autoCropArea)||.8,a=this.canvasData,s={width:a.width,height:a.height};i&&(a.height*i>a.width?s.height=s.width/i:s.width=s.height*i),this.cropBoxData=s,this.limitCropBox(!0,!0),s.width=Et(Rt(s.width,s.minWidth),s.maxWidth),s.height=Et(Rt(s.height,s.minHeight),s.maxHeight),s.width=Rt(s.minWidth,s.width*e),s.height=Rt(s.minHeight,s.height*e),s.oldLeft=s.left=a.left+(a.width-s.width)/2,s.oldTop=s.top=a.top+(a.height-s.height)/2,this.initialCropBoxData=g({},s)},limitCropBox:function(t,i){var e,a,s,n,o=this.options,h=o.aspectRatio,r=this.containerData,c=r.width,l=r.height,p=this.canvasData,d=this.cropBoxData,u=this.isLimited;t&&(e=Ht(o.minCropBoxWidth)||0,a=Ht(o.minCropBoxHeight)||0,e=Et(e,c),a=Et(a,l),s=Et(c,u?p.width:c),n=Et(l,u?p.height:l),h&&(e&&a?a*h>e?a=e/h:e=a*h:e?a=e/h:a&&(e=a*h),n*h>s?n=s/h:s=n*h),d.minWidth=Et(e,s),d.minHeight=Et(a,n),d.maxWidth=s,d.maxHeight=n),i&&(u?(d.minLeft=Rt(0,p.left),d.minTop=Rt(0,p.top),d.maxLeft=Et(c,p.left+p.width)-d.width,d.maxTop=Et(l,p.top+p.height)-d.height):(d.minLeft=0,d.minTop=0,d.maxLeft=c-d.width,d.maxTop=l-d.height))},renderCropBox:function(){var t=this.options,i=this.containerData,e=i.width,a=i.height,s=this.cropBoxData;(s.width>s.maxWidth||s.width<s.minWidth)&&(s.left=s.oldLeft),(s.height>s.maxHeight||s.height<s.minHeight)&&(s.top=s.oldTop),s.width=Et(Rt(s.width,s.minWidth),s.maxWidth),s.height=Et(Rt(s.height,s.minHeight),s.maxHeight),this.limitCropBox(!1,!0),s.oldLeft=s.left=Et(Rt(s.left,s.minLeft),s.maxLeft),s.oldTop=s.top=Et(Rt(s.top,s.minTop),s.maxTop),t.movable&&t.cropBoxDataMovable&&C(this.face,vt,s.width===e&&s.height===a?Mt:Tt),this.cropBox.style.cssText="width:"+s.width+"px;height:"+s.height+"px;left:"+s.left+"px;top:"+s.top+"px;",this.isCropped&&this.isLimited&&this.limitCanvas(!0,!0),this.isDisabled||this.output()},output:function(){var t=this.options;this.preview(),this.isCompleted&&r(t.crop)&&t.crop.call(this.element,this.getData())}}),g(St,{initPreview:function(){var t,i=this.options.preview,e=j.createElement("img"),a=this.crossOrigin,s=a?this.crossOriginUrl:this.url;a&&(e.crossOrigin=a),e.src=s,H(this.viewBox,e),i&&(this.previews=t=W(j,i),u(t,function(t){var i=j.createElement("img");C(t,mt,{width:t.offsetWidth,height:t.offsetHeight,html:t.innerHTML}),a&&(i.crossOrigin=a),i.src=s,i.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',R(t),H(t,i)}))},resetPreview:function(){u(this.previews,function(t){var i=D(t,mt);t.style.width=i.width+"px",t.style.height=i.height+"px",t.innerHTML=i.html,B(t,mt)})},preview:function(){var t=this.imageData,i=this.canvasData,e=this.cropBoxData,a=e.width,s=e.height,n=t.width,o=t.height,h=e.left-i.left-t.left,r=e.top-i.top-t.top,c=I(t);this.isCropped&&!this.isDisabled&&(X(this.viewBox,"img").style.cssText="width:"+n+"px;height:"+o+"px;margin-left:"+-h+"px;margin-top:"+-r+"px;-webkit-transform:"+c+";-ms-transform:"+c+";transform:"+c+";",u(this.previews,function(t){var i=X(t,"img").style,e=D(t,mt),l=e.width,p=e.height,d=l,u=p,g=1;a&&(g=l/a,u=s*g),s&&u>p&&(g=p/s,d=a*g,u=p),t.style.width=d+"px",t.style.height=u+"px",i.width=n*g+"px",i.height=o*g+"px",i.marginLeft=-h*g+"px",i.marginTop=-r*g+"px",i.WebkitTransform=c,i.msTransform=c,i.transform=c}))}}),g(St,{bind:function(){var i=this.options,e=this.cropper;y(e,nt,f(this.cropStart,this)),i.zoomable&&i.zoomOnWheel&&y(e,rt,f(this.wheel,this)),i.toggleDragModeOnDblclick&&y(e,ct,f(this.dblclick,this)),y(j,ot,this._cropMove=f(this.cropMove,this)),y(j,ht,this._cropEnd=f(this.cropEnd,this)),i.responsive&&y(t,lt,this._resize=f(this.resize,this))},unbind:function(){var i=this.options,e=this.cropper;L(e,nt,this.cropStart),i.zoomable&&i.zoomOnWheel&&L(e,rt,this.wheel),i.toggleDragModeOnDblclick&&L(e,ct,this.dblclick),L(j,ot,this._cropMove),L(j,ht,this._cropEnd),i.responsive&&L(t,lt,this._resize)}}),g(St,{resize:function(){var t,i,e,a=this.options.restore,s=this.container,n=this.containerData;!this.isDisabled&&n&&(e=s.offsetWidth/n.width,(1!==e||s.offsetHeight!==n.height)&&(a&&(t=this.getCanvasData(),i=this.getCropBoxData()),this.render(),a&&(this.setCanvasData(u(t,function(i,a){t[a]=i*e})),this.setCropBoxData(u(i,function(t,a){i[a]=t*e})))))},dblclick:function(){this.isDisabled||this.setDragMode(v(this.dragBox,et)?Mt:kt)},wheel:function(t){var i=k(t),e=Ht(this.options.wheelZoomRatio)||.1,a=1;this.isDisabled||(T(i),i.deltaY?a=i.deltaY>0?1:-1:i.wheelDelta?a=-i.wheelDelta/120:i.detail&&(a=i.detail>0?1:-1),this.zoom(-a*e,i))},cropStart:function(t){var i,e,a,s=this.options,n=k(t),o=n.touches;if(!this.isDisabled){if(o){if(i=o.length,i>1){if(!s.zoomable||!s.zoomOnTouch||2!==i)return;e=o[1],this.startX2=e.pageX,this.startY2=e.pageY,a=Xt}e=o[0]}if(a=a||D(n.target,vt),ut.test(a)){if(r(s.cropstart)&&s.cropstart.call(this.element,{originalEvent:n,action:a})===!1)return;T(n),this.action=a,this.cropping=!1,this.startX=e?e.pageX:n.pageX,this.startY=e?e.pageY:n.pageY,a===kt&&(this.cropping=!0,w(this.dragBox,G))}}},cropMove:function(t){var i,e,a=this.options,s=k(t),n=s.touches,o=this.action;if(!this.isDisabled){if(n){if(i=n.length,i>1){if(!a.zoomable||!a.zoomOnTouch||2!==i)return;e=n[1],this.endX2=e.pageX,this.endY2=e.pageY}e=n[0]}if(o){if(r(a.cropmove)&&a.cropmove.call(this.element,{originalEvent:s,action:o})===!1)return;T(s),this.endX=e?e.pageX:s.pageX,this.endY=e?e.pageY:s.pageY,this.change(s.shiftKey,o===Xt?s:null)}}},cropEnd:function(t){var i=this.options,e=k(t),a=this.action;this.isDisabled||a&&(T(e),this.cropping&&(this.cropping=!1,b(this.dragBox,G,this.isCropped&&i.modal)),this.action="",r(i.cropend)&&i.cropend.call(this.element,{originalEvent:e,action:a}))}}),g(St,{change:function(t,i){var e,a,s=this.options,n=s.aspectRatio,o=this.action,h=this.containerData,r=this.canvasData,c=this.cropBoxData,l=c.width,p=c.height,d=c.left,u=c.top,g=d+l,f=u+p,m=0,v=0,w=h.width,b=h.height,D=!0;switch(!n&&t&&(n=l&&p?l/p:1),this.isLimited&&(m=c.minLeft,v=c.minTop,w=m+Et(h.width,r.width),b=v+Et(h.height,r.height)),a={x:this.endX-this.startX,y:this.endY-this.startY},n&&(a.X=a.y*n,a.Y=a.x/n),o){case Tt:d+=a.x,u+=a.y;break;case wt:if(a.x>=0&&(g>=w||n&&(v>=u||f>=b))){D=!1;break}l+=a.x,n&&(p=l/n,u-=a.Y/2),0>l&&(o=xt,l=0);break;case Dt:if(a.y<=0&&(v>=u||n&&(m>=d||g>=w))){D=!1;break}p-=a.y,u+=a.y,n&&(l=p*n,d+=a.X/2),0>p&&(o=bt,p=0);break;case xt:if(a.x<=0&&(m>=d||n&&(v>=u||f>=b))){D=!1;break}l-=a.x,d+=a.x,n&&(p=l/n,u+=a.Y/2),0>l&&(o=wt,l=0);break;case bt:if(a.y>=0&&(f>=b||n&&(m>=d||g>=w))){D=!1;break}p+=a.y,n&&(l=p*n,d-=a.X/2),0>p&&(o=Dt,p=0);break;case yt:if(n){if(a.y<=0&&(v>=u||g>=w)){D=!1;break}p-=a.y,u+=a.y,l=p*n}else a.x>=0?w>g?l+=a.x:a.y<=0&&v>=u&&(D=!1):l+=a.x,a.y<=0?u>v&&(p-=a.y,u+=a.y):(p-=a.y,u+=a.y);0>l&&0>p?(o=Bt,p=0,l=0):0>l?(o=Lt,l=0):0>p&&(o=Ct,p=0);break;case Lt:if(n){if(a.y<=0&&(v>=u||m>=d)){D=!1;break}p-=a.y,u+=a.y,l=p*n,d+=a.X}else a.x<=0?d>m?(l-=a.x,d+=a.x):a.y<=0&&v>=u&&(D=!1):(l-=a.x,d+=a.x),a.y<=0?u>v&&(p-=a.y,u+=a.y):(p-=a.y,u+=a.y);0>l&&0>p?(o=Ct,p=0,l=0):0>l?(o=yt,l=0):0>p&&(o=Bt,p=0);break;case Bt:if(n){if(a.x<=0&&(m>=d||f>=b)){D=!1;break}l-=a.x,d+=a.x,p=l/n}else a.x<=0?d>m?(l-=a.x,d+=a.x):a.y>=0&&f>=b&&(D=!1):(l-=a.x,d+=a.x),a.y>=0?b>f&&(p+=a.y):p+=a.y;0>l&&0>p?(o=yt,p=0,l=0):0>l?(o=Ct,l=0):0>p&&(o=Lt,p=0);break;case Ct:if(n){if(a.x>=0&&(g>=w||f>=b)){D=!1;break}l+=a.x,p=l/n}else a.x>=0?w>g?l+=a.x:a.y>=0&&f>=b&&(D=!1):l+=a.x,a.y>=0?b>f&&(p+=a.y):p+=a.y;0>l&&0>p?(o=Lt,p=0,l=0):0>l?(o=Bt,l=0):0>p&&(o=yt,p=0);break;case Mt:this.move(a.x,a.y),D=!1;break;case Xt:this.zoom(function(t,i,e,a){var s=It(t*t+i*i),n=It(e*e+a*a);return(n-s)/s}(zt(this.startX-this.startX2),zt(this.startY-this.startY2),zt(this.endX-this.endX2),zt(this.endY-this.endY2)),i),this.startX2=this.endX2,this.startY2=this.endY2,D=!1;break;case kt:if(!a.x||!a.y){D=!1;break}e=M(this.cropper),d=this.startX-e.left,u=this.startY-e.top,l=c.minWidth,p=c.minHeight,a.x>0?o=a.y>0?Ct:yt:a.x<0&&(d-=l,o=a.y>0?Bt:Lt),a.y<0&&(u-=p),this.isCropped||(x(this.cropBox,Q),this.isCropped=!0,this.isLimited&&this.limitCropBox(!0,!0))}D&&(c.width=l,c.height=p,c.left=d,c.top=u,this.action=o,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY}}),g(St,{crop:function(){return this.isBuilt&&!this.isDisabled&&(this.isCropped||(this.isCropped=!0,this.limitCropBox(!0,!0),this.options.modal&&w(this.dragBox,G),x(this.cropBox,Q)),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.isBuilt&&!this.isDisabled&&(this.imageData=g({},this.initialImageData),this.canvasData=g({},this.initialCanvasData),this.cropBoxData=g({},this.initialCropBoxData),this.renderCanvas(),this.isCropped&&this.renderCropBox()),this},clear:function(){return this.isCropped&&!this.isDisabled&&(g(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.isCropped=!1,this.renderCropBox(),this.limitCanvas(),this.renderCanvas(),x(this.dragBox,G),w(this.cropBox,Q)),this},replace:function(t){return!this.isDisabled&&t&&(this.isImg&&(this.isReplaced=!0,this.element.src=t),this.options.data=null,this.load(t)),this},enable:function(){return this.isBuilt&&(this.isDisabled=!1,x(this.cropper,at)),this},disable:function(){return this.isBuilt&&(this.isDisabled=!0,w(this.cropper,at)),this},destroy:function(){var t=this.element,i=this.image;return this.isLoaded?(this.isImg&&this.isReplaced&&(t.src=this.originalUrl),this.unbuild(),x(t,Q)):this.isImg?t.off(dt,this.start):i&&E(i),B(t,K),this},move:function(t,i){var e=this.canvasData;return this.moveTo(n(t)?t:e.left+Ht(t),n(i)?i:e.top+Ht(i))},moveTo:function(t,i){var e=this.canvasData,a=!1;return n(i)&&(i=t),t=Ht(t),i=Ht(i),this.isBuilt&&!this.isDisabled&&this.options.movable&&(s(t)&&(e.left=t,a=!0),s(i)&&(e.top=i,a=!0),a&&this.renderCanvas(!0)),this},zoom:function(t,i){var e=this.canvasData;return t=Ht(t),t=0>t?1/(1-t):1+t,this.zoomTo(e.width*t/e.naturalWidth,i)},zoomTo:function(t,i){var e,a,s=this.options,n=this.canvasData,o=n.width,h=n.height,c=n.naturalWidth,l=n.naturalHeight;if(t=Ht(t),t>=0&&this.isBuilt&&!this.isDisabled&&s.zoomable){if(e=c*t,a=l*t,r(s.zoom)&&s.zoom.call(this.element,{originalEvent:i,oldRatio:o/c,ratio:e/c})===!1)return this;n.left-=(e-o)/2,n.top-=(a-h)/2,n.width=e,n.height=a,this.renderCanvas(!0)}return this},rotate:function(t){return this.rotateTo((this.imageData.rotate||0)+Ht(t))},rotateTo:function(t){return t=Ht(t),s(t)&&this.isBuilt&&!this.isDisabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.isRotated=!0,this.renderCanvas(!0)),this},scale:function(t,i){var e=this.imageData,a=!1;return n(i)&&(i=t),t=Ht(t),i=Ht(i),this.isBuilt&&!this.isDisabled&&this.options.scalable&&(s(t)&&(e.scaleX=t,a=!0),s(i)&&(e.scaleY=i,a=!0),a&&this.renderImage(!0)),this},scaleX:function(t){var i=this.imageData.scaleY;return this.scale(t,s(i)?i:1)},scaleY:function(t){var i=this.imageData.scaleX;return this.scale(s(i)?i:1,t)},getData:function(t){var i,e,a=this.options,s=this.imageData,n=this.canvasData,o=this.cropBoxData;return this.isBuilt&&this.isCropped?(e={x:o.left-n.left,y:o.top-n.top,width:o.width,height:o.height},i=s.width/s.naturalWidth,u(e,function(a,s){a/=i,e[s]=t?At(a):a})):e={x:0,y:0,width:0,height:0},a.rotatable&&(e.rotate=s.rotate||0),a.scalable&&(e.scaleX=s.scaleX||1,e.scaleY=s.scaleY||1),e},setData:function(t){var i,e,a,n=this.options,o=this.imageData,c=this.canvasData,l={};return r(t)&&(t=t.call(this.element)),this.isBuilt&&!this.isDisabled&&h(t)&&(n.rotatable&&s(t.rotate)&&t.rotate!==o.rotate&&(o.rotate=t.rotate,this.isRotated=i=!0),n.scalable&&(s(t.scaleX)&&t.scaleX!==o.scaleX&&(o.scaleX=t.scaleX,e=!0),s(t.scaleY)&&t.scaleY!==o.scaleY&&(o.scaleY=t.scaleY,e=!0)),i?this.renderCanvas():e&&this.renderImage(),a=o.width/o.naturalWidth,s(t.x)&&(l.left=t.x*a+c.left),s(t.y)&&(l.top=t.y*a+c.top),s(t.width)&&(l.width=t.width*a),s(t.height)&&(l.height=t.height*a),this.setCropBoxData(l)),this},getContainerData:function(){return this.isBuilt?this.containerData:{}},getImageData:function(){return this.isLoaded?this.imageData:{}},getCanvasData:function(){var t=this.canvasData,i={};return this.isBuilt&&u(["left","top","width","height","naturalWidth","naturalHeight"],function(e){i[e]=t[e]}),i},setCanvasData:function(t){var i=this.canvasData,e=i.aspectRatio;return r(t)&&(t=t.call(this.element)),this.isBuilt&&!this.isDisabled&&h(t)&&(s(t.left)&&(i.left=t.left),s(t.top)&&(i.top=t.top),s(t.width)?(i.width=t.width,i.height=t.width/e):s(t.height)&&(i.height=t.height,i.width=t.height*e),this.renderCanvas(!0)),this},getCropBoxData:function(){var t,i=this.cropBoxData;return this.isBuilt&&this.isCropped&&(t={left:i.left,top:i.top,width:i.width,height:i.height}),t||{}},setCropBoxData:function(t){var i,e,a=this.cropBoxData,n=this.options.aspectRatio;return r(t)&&(t=t.call(this.element)),this.isBuilt&&this.isCropped&&!this.isDisabled&&h(t)&&(s(t.left)&&(a.left=t.left),s(t.top)&&(a.top=t.top),s(t.width)&&t.width!==a.width&&(i=!0,a.width=t.width),s(t.height)&&t.height!==a.height&&(e=!0,a.height=t.height),n&&(i?a.height=a.width/n:e&&(a.width=a.height*n)),this.renderCropBox()),this},getCroppedCanvas:function(t){var i,e,a,s,n,o,r,c,l,p,d;return this.isBuilt&&this.isCropped&&Yt?(h(t)||(t={}),d=this.getData(),i=d.width,e=d.height,c=i/e,h(t)&&(n=t.width,o=t.height,n?(o=n/c,r=n/i):o&&(n=o*c,r=o/e)),a=At(n||i),s=At(o||e),l=j.createElement("canvas"),l.width=a,l.height=s,p=l.getContext("2d"),t.fillColor&&(p.fillStyle=t.fillColor,p.fillRect(0,0,a,s)),p.drawImage.apply(p,function(){var t,a,s,n,o,h,c=N(this.image,this.imageData),l=c.width,p=c.height,u=[c],g=d.x,f=d.y;return-i>=g||g>l?g=t=s=o=0:0>=g?(s=-g,g=0,t=o=Et(l,i+g)):l>=g&&(s=0,t=o=Et(i,l-g)),0>=t||-e>=f||f>p?f=a=n=h=0:0>=f?(n=-f,f=0,a=h=Et(p,e+f)):p>=f&&(n=0,a=h=Et(e,p-f)),u.push(Nt(g),Nt(f),Nt(t),Nt(a)),r&&(s*=r,n*=r,o*=r,h*=r),o>0&&h>0&&u.push(Nt(s),Nt(n),Nt(o),Nt(h)),u}.call(this)),l):void 0},setAspectRatio:function(t){var i=this.options;return this.isDisabled||n(t)||(i.aspectRatio=Rt(0,t)||NaN,this.isBuilt&&(this.initCropBox(),this.isCropped&&this.renderCropBox())),this},setDragMode:function(t){var i,e,a=this.options,s=this.dragBox,n=this.face;return this.isLoaded&&!this.isDisabled&&(i=t===kt,e=a.movable&&t===Mt,t=i||e?t:Wt,C(s,vt,t),b(s,et,i),b(s,it,e),a.cropBoxMovable||(C(n,vt,t),b(n,et,i),b(n,it,e))),this}}),g(_.prototype,St),_.DEFAULTS={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},_.TEMPLATE='<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>';var Ft=t.Cropper;return _.noConflict=function(){return t.Cropper=Ft,_},_.setDefaults=function(t){g(_.DEFAULTS,t)},"function"==typeof define&&define.amd&&define("cropper",[],function(){return _}),"undefined"==typeof i&&(t.Cropper=_),_});